# 🚀 PubMed2EndNote 簡単セットアップガイド

**自動セットアップスクリプトを使用した超簡単インストール方法**

## 📋 準備するもの

- Windows PC（Windows 10/11）
- Google Chrome ブラウザ
- インターネット接続

## 🎯 たった3ステップで完了！

### ステップ1: ファイルをダウンロード

1. **GitHubページにアクセス**
   ```
   https://github.com/matsuikentaro1/pubmed2endnote
   ```

2. **ZIPファイルをダウンロード**
   - 緑色の「Code」ボタン → 「Download ZIP」をクリック
   - ダウンロードしたZIPファイルを展開
   - **デスクトップ**に保存することを推奨

### ステップ2: 自動セットアップを実行

1. **setup.ps1を実行**
   - `pubmed2endnote-main` フォルダを開く
   - `setup.ps1` ファイルを右クリック
   - 「PowerShellで実行」をクリック

2. **セットアップウィザードに従う**
   - Pythonが自動でチェックされます
   - 必要なライブラリが自動でインストールされます
   - 指示に従って拡張機能IDを入力

### ステップ3: Chrome拡張機能をインストール

1. **拡張機能をインストール**
   - Chromeで `chrome://extensions/` を開く
   - 「デベロッパーモード」をON
   - 「パッケージ化されていない拡張機能を読み込む」
   - `PubMed2EndNote_1.0.0` フォルダを選択

2. **拡張機能IDをコピー**
   - インストールされた拡張機能の「ID」をコピー
   - セットアップスクリプトに貼り付け

## ✨ セットアップスクリプトの機能

### 🔍 自動チェック機能
- ✅ Python環境の確認
- ✅ 必要ライブラリ（pywin32）の自動インストール
- ✅ 必要ファイルの存在確認
- ✅ 拡張機能IDの形式検証

### 🛠️ 自動設定機能
- ✅ 設定ファイル（com.pubmed.endnote.json）の自動生成
- ✅ レジストリファイル（register_native_host.reg）の自動生成
- ✅ 絶対パスの自動設定
- ✅ Windowsレジストリへの自動登録

### 🎯 エラー予防機能
- ✅ 拡張機能IDの形式チェック（32文字英数字）
- ✅ 管理者権限の自動確認
- ✅ ファイルパスの自動エスケープ処理
- ✅ 基本動作テストの実行

## 🆘 トラブルシューティング

### PowerShellスクリプトが実行できない
```powershell
# 実行ポリシーを一時的に変更
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Python が見つからない
1. https://www.python.org/downloads/ からPythonをダウンロード
2. インストール時に「Add Python to PATH」にチェック
3. コマンドプロンプトで `python --version` で確認

### 管理者権限が必要
- `setup.ps1` を右クリック → 「管理者として実行」

## 🎉 完了後の使い方

1. **初回設定**
   - Chrome拡張機能の設定でメールアドレスを入力

2. **論文引用のコピー**
   - PubMedで論文ページを開く
   - 右上の青いアイコンをクリック
   - 「Successfully copied!」を確認

3. **Wordで使用**
   - Microsoft Wordで `Ctrl+V` で貼り付け
   - EndNoteタブで「Update Citations」を実行

## ⚠️ 重要な注意事項

- **フォルダを移動しない**: セットアップ後は `pubmed2endnote-main` フォルダを移動・削除しないでください
- **Pythonが必要**: この拡張機能はPythonランタイムが必要です
- **Windows専用**: macOSやLinuxでは動作しません

## 🔧 手動セットアップとの比較

| 項目 | 手動セットアップ | 自動セットアップ |
|------|----------------|-----------------|
| 所要時間 | 15-30分 | 5分 |
| エラー率 | 高い | 低い |
| 技術知識 | 必要 | 不要 |
| パス設定 | 手動 | 自動 |
| ファイル編集 | 手動 | 自動 |

## 📞 サポート

問題が発生した場合：
1. セットアップスクリプトのエラーメッセージを確認
2. `native_host.log` ファイルでエラー詳細を確認
3. GitHubのIssuesで報告

---

**このセットアップ方法により、従来の複雑な手動設定を大幅に簡素化できます！**