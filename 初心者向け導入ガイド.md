# 【超初心者向け】PubMed2EndNote拡張機能 完全導入ガイド

このガイドは、プログラミングやコマンドラインの知識がない方でも、PubMed2EndNote拡張機能を安全にインストールできるよう、図解と詳細な手順で説明しています。

## 🎯 この拡張機能でできること

- PubMedの論文ページで**青いアイコンをクリックするだけ**
- 論文情報が自動でクリップボードにコピーされる
- Microsoft Wordに貼り付けると、**EndNoteの引用として自動認識**
- 参考文献リストも自動生成される

## ⚠️ 重要な注意事項

**この拡張機能はWindowsでのみ動作します。** MacやLinuxでは使用できません。

## 📋 必要なもの

1. **Windows PC**（Windows 10/11推奨）
2. **Google Chrome**または**Microsoft Edge**ブラウザ
3. **Python**（無料ソフト、後で詳しく説明）
4. **Microsoft Word + EndNote**（論文執筆用）

## 🚀 ステップ1: Pythonのインストール

### なぜPythonが必要？
この拡張機能は、WordがEndNoteの引用を正しく認識するために、特殊な形式でクリップボードにデータを保存する必要があります。そのためにPythonというプログラミング言語を使用します。

### Pythonのダウンロードとインストール

1. **Python公式サイトにアクセス**
   - ブラウザで https://www.python.org/downloads/ を開く

2. **Pythonをダウンロード**
   - 黄色い「Download Python 3.xx.x」ボタンをクリック
   - ファイルがダウンロードされるまで待つ

3. **Pythonをインストール**
   - ダウンロードした.exeファイルをダブルクリック
   - **重要**: 「Add Python to PATH」にチェックを入れる
   - 「Install Now」をクリック
   - インストール完了まで待つ（数分かかります）

4. **インストール確認**
   - Windowsキー + R を押す
   - 「cmd」と入力してEnterキー
   - 黒い画面（コマンドプロンプト）が開く
   - 「python --version」と入力してEnterキー
   - 「Python 3.xx.x」と表示されればOK
   - 黒い画面を閉じる

## 🚀 ステップ2: 拡張機能ファイルのダウンロード

1. **GitHubページにアクセス**
   - ブラウザで https://github.com/matsuikentaro1/pubmed2endnote を開く

2. **ファイルをダウンロード**
   - 緑色の「Code」ボタンをクリック
   - 「Download ZIP」をクリック
   - ZIPファイルがダウンロードされるまで待つ

3. **ファイルを解凍**
   - ダウンロードフォルダでZIPファイルを右クリック
   - 「すべて展開」をクリック
   - 展開先は「デスクトップ」を推奨
   - 「展開」をクリック

## 🚀 ステップ3: 必要なライブラリのインストール

### pywin32ライブラリのインストール

1. **コマンドプロンプトを開く**
   - Windowsキー + R を押す
   - 「cmd」と入力してEnterキー

2. **ライブラリをインストール**
   - 黒い画面で「pip install pywin32」と入力
   - Enterキーを押す
   - インストールが始まります（1-2分かかります）
   - 「Successfully installed」と表示されればOK
   - 黒い画面を閉じる

## 🚀 ステップ4: Chrome拡張機能のインストール

1. **Google Chromeを開く**

2. **拡張機能ページにアクセス**
   - アドレスバーに「chrome://extensions/」と入力
   - Enterキーを押す

3. **デベロッパーモードをオンにする**
   - 右上の「デベロッパーモード」スイッチをクリック
   - スイッチが青色になればOK

4. **拡張機能を読み込む**
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - ファイル選択画面が開く
   - デスクトップ → pubmed2endnote-main → PubMed2EndNote_1.0.0 フォルダを選択
   - 「フォルダーの選択」をクリック

5. **インストール確認**
   - 拡張機能一覧に「PubMed2EndNote」が表示されればOK
   - **拡張機能ID**をメモ帳などにコピーして保存（後で使用）

## 🚀 ステップ5: 設定ファイルの編集

1. **設定ファイルを開く**
   - デスクトップ → pubmed2endnote-main フォルダを開く
   - 「com.pubmed.endnote.json」ファイルを右クリック
   - 「プログラムから開く」→「メモ帳」をクリック

2. **拡張機能IDを更新**
   ```json
   "allowed_origins": [
       "chrome-extension://fkodopnhfpbefmkjagbdmjbdnalpiegi/"
   ]
   ```
   - 上記の「fkodopnhfpbefmkjagbdmjbdnalpiegi」部分を
   - ステップ4でコピーした**あなたの拡張機能ID**に変更
   - ファイルを保存（Ctrl + S）

3. **パスを更新**
   - 同じファイル内の「path」行を探す
   - 「C:\\Users\\Kentaro Matsui\\Dropbox\\...」部分を
   - あなたのファイルの実際の場所に変更
   - 例: 「C:\\Users\\あなたの名前\\Desktop\\pubmed2endnote-main\\native_host.bat」

## 🚀 ステップ6: Windowsへの登録

1. **レジストリファイルを開く**
   - デスクトップ → pubmed2endnote-main フォルダを開く
   - 「register_native_host.reg」ファイルを右クリック
   - 「編集」をクリック

2. **パスを更新**
   - ファイル内のパスを、あなたの実際のフォルダの場所に変更
   - 例: 「C:\\Users\\あなたの名前\\Desktop\\pubmed2endnote-main\\com.pubmed.endnote.json」
   - ファイルを保存（Ctrl + S）

3. **レジストリに登録**
   - 更新した「register_native_host.reg」ファイルをダブルクリック
   - 「レジストリエディターでの変更を許可しますか？」→「はい」
   - 「正常に追加されました」→「OK」

## 🚀 ステップ7: 初回設定

1. **設定ページを開く**
   - Chromeの右上にある拡張機能アイコン（パズルピース）をクリック
   - 「PubMed2EndNote」の歯車アイコンをクリック

2. **メールアドレスを設定**
   - PubMed API用のメールアドレスを入力
   - 「Save Settings」をクリック
   - 緑色のメッセージが表示されればOK

## 🎉 使い方

1. **PubMedで論文を検索**
   - https://pubmed.ncbi.nlm.nih.gov/ で論文を検索
   - 興味のある論文をクリック

2. **引用をコピー**
   - 論文ページの右上に**青いアイコン**が表示される
   - アイコンをクリック
   - 「Successfully copied to clipboard!」と表示されればOK

3. **Wordに貼り付け**
   - Microsoft Wordを開く
   - 論文を書いている箇所にカーソルを置く
   - Ctrl + V で貼り付け
   - 「(1)」という引用番号が表示される

4. **引用を更新**
   - Wordの「EndNote」タブをクリック
   - 「Update Citations and Bibliography」をクリック
   - 引用が正式なフォーマットに変換される

## 🆘 よくある問題と解決法

### 「Native host communication error」エラー
**原因**: Pythonまたはライブラリが正しくインストールされていない
**解決法**:
1. コマンドプロンプトで「python --version」を実行
2. バージョンが表示されない場合、Pythonを再インストール
3. 「pip install pywin32」を再実行

### 青いアイコンが表示されない
**原因**: 拡張機能が正しく動作していない
**解決法**:
1. PubMedの論文ページにいることを確認（URLにPMIDが含まれている）
2. ページを再読み込み（F5キー）
3. 拡張機能が有効になっているか確認

### Wordで引用が認識されない
**原因**: クリップボードの形式が正しくない
**解決法**:
1. 設定ファイルのパスが正しいか確認
2. レジストリ登録を再実行
3. Chromeを完全に再起動

## 📞 サポート

この手順でうまくいかない場合は、以下を確認してください：

1. **エラーメッセージの確認**
   - pubmed2endnote-main フォルダ内の「native_host.log」ファイルを開く
   - エラーメッセージを確認

2. **ファイルの場所確認**
   - すべてのファイルが正しい場所にあるか確認
   - パスに日本語や特殊文字が含まれていないか確認

3. **再インストール**
   - すべての手順を最初からやり直す
   - 古いファイルを削除してから再実行

## 🎯 まとめ

この拡張機能を使うことで、PubMedから論文情報をワンクリックでEndNote形式に変換できます。設定は少し複雑ですが、一度設定すれば論文執筆が格段に楽になります。

**重要**: 設定が完了したら、pubmed2endnote-main フォルダを削除したり移動したりしないでください。拡張機能が動作しなくなります。